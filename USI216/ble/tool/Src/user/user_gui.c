/**
 ****************************************************************************************
 *
 * @file user_gui.c
 *
 * @brief Graphical user interface implementation
 *
 *****************************************************************************************
 */

/*
 * INCLUDE FILES
 ****************************************************************************************
 */
#include "user_gui.h"
#include "boards.h"
#include "gui_include.h"
#include "st7735.h"
#include <string.h>
#include <stdio.h>

#include "user_app.h"
#include "maxeye_font_16x16.h"
#include "app_timer.h"
#include "app_log.h"
#include "app_error.h"


#include "maxeye_nvds.h"
/*
 * DEFINES
 *****************************************************************************************
 */

#define BLUE_COLOR      0xF800     /**< blue. */
#define RED_COLOR       0x00F8     /**< red. */
#define GREEN_COLOR     0xE007     /**< green. 绿色*/ 
#define BLACK_COLOR     0          /**< black. 黑色*/ 
#define WHITE_COLOR     0xFFFF     /**< black. 黑色*/ 
#define BACK_COLOR      BLACK_COLOR    
/*
 * LOCAL VARIABLE DEFINITIONS
 *****************************************************************************************
 */

/**@brief Font code. */


/*
 ****************************************************************************************
 * 阴码
 * 顺向
 * 行列


 
 ****************************************************************************************
 */



static const uint8_t waitStr[][16]={
{0x30,0x3F,0x6C,0xC7,0x01,0x3F,0x01,0x01,0xFF,0x00,0x00,0x7F,0x0C,0x06,0x06,0x00},
{0x60,0xFF,0xD8,0x8C,0x80,0xFC,0x80,0x80,0xFF,0x00,0x30,0xFE,0x30,0x30,0xF0,0x60},/*"等",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x0C,0x0C,0x18,0x33,0x6C,0x0C,0x1F,0x38,0x78,0xDF,0x18,0x1B,0x19,0x19,0x18,0x18},
{0x60,0x60,0x60,0xFE,0x60,0x60,0xFF,0x18,0x18,0xFF,0x18,0x18,0x98,0x98,0x78,0x30},/*"待",1*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x30,0x1F,0x18,0x00,0x01,0xFB,0x18,0x18,0x18,0x1F,0x18,0x18,0x3C,0x67,0x00},
{0x60,0x60,0xFF,0xC0,0xF0,0xB0,0xFE,0x30,0x30,0x30,0xFF,0x30,0x30,0x30,0xFF,0x00},/*"连",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x18,0x18,0x1B,0x18,0xFF,0x18,0x1F,0x18,0x1C,0x3F,0xF8,0x19,0x18,0x18,0x79,0x37},
{0xC0,0x60,0xFE,0x00,0x8C,0xD8,0xFF,0x60,0x60,0xFF,0xCC,0x8C,0xD8,0x70,0xDC,0x06},/*"接",3*/
/* (16 X 16 , 宋体, 加粗 )*/

};



static const uint8_t disCoverStr[][16]={
{0x01,0x19,0x19,0x33,0x3F,0x03,0x06,0x07,0x0F,0x0D,0x19,0x18,0x30,0x60,0x03,0x1E},
{0x80,0x98,0x8C,0x00,0xFE,0x00,0x00,0xFC,0x0C,0x8C,0x98,0xF0,0x60,0xF0,0x9C,0x07},/*"发",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x01,0xFF,0x19,0x19,0x19,0x19,0x7F,0x19,0x19,0x18,0x18,0x1E,0xF1,0x63,0x06},
{0x00,0xFE,0x86,0x86,0xB6,0xB6,0xB6,0xB6,0xB6,0xFE,0x78,0xD8,0xD8,0x9B,0x1B,0x0F},/*"现",1*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x31,0x19,0x19,0x01,0x03,0xFE,0x1B,0x19,0x19,0x18,0x1E,0x1C,0x18,0x03,0x0E},
{0x00,0xF8,0x98,0x98,0x98,0x0F,0x00,0xFC,0x8C,0x98,0xD8,0xF0,0x60,0xF0,0x9C,0x07},/*"设",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x06,0x06,0x0F,0x1C,0x76,0x03,0x1E,0xF0,0x1F,0x19,0x19,0x1F,0x19,0x19,0x1F,0x18},
{0x00,0x00,0xF8,0x30,0x60,0xC0,0x78,0x0F,0xF8,0x98,0x98,0xF8,0x98,0x98,0xF8,0x18},/*"备",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};


static const uint8_t encOkStr[][16]={

{0x00,0x3F,0x00,0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x20,0x20,0x20,0x20,0x1F,0x00},
{0x00,0xF0,0x10,0x10,0x10,0x10,0x10,0xF0,0x00,0x00,0x00,0x04,0x04,0x04,0xFC,0x00},/*"已",0*/
/* (16 X 16 , 宋体 )*/

{0x10,0x13,0x10,0x12,0xFD,0x11,0x17,0x14,0x18,0x33,0xD1,0x11,0x10,0x10,0x51,0x26},
{0x1C,0xE0,0x84,0x44,0x48,0x10,0xFE,0x02,0x00,0xF8,0x08,0x10,0xA0,0x40,0xB0,0x0E},/*"授",1*/
/* (16 X 16 , 宋体 )*/

{0x10,0x13,0x11,0x11,0xFD,0x10,0x30,0x38,0x54,0x54,0x90,0x10,0x10,0x10,0x11,0x16},
{0x00,0xFC,0x04,0x04,0x04,0x88,0x88,0x88,0x50,0x50,0x20,0x20,0x50,0x88,0x04,0x02},/*"权",2*/
/* (16 X 16 , 宋体 )*/
};


static const uint8_t writeEncOkStr[][16]={
{0x18,0x1B,0x18,0x1B,0xFF,0x19,0x1F,0x1E,0x1C,0x3B,0xF9,0x19,0x18,0x18,0x79,0x37},
{0x1E,0xF0,0xC6,0x66,0xEC,0x98,0xFF,0x03,0x00,0xFC,0x8C,0x98,0xF0,0x60,0xF8,0x0F},/*"授",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x18,0x1B,0x19,0x19,0xFF,0x18,0x38,0x3C,0x7E,0x7E,0xD8,0x18,0x18,0x18,0x19,0x1F},
{0x00,0xFE,0x86,0x86,0x86,0xCC,0xCC,0xCC,0x78,0x78,0x30,0x30,0x78,0xCC,0x86,0x03},/*"权",1*/
/* (16 X 16 , 宋体, 加粗 )*/


{0x00,0x00,0x00,0x3F,0x30,0x30,0x30,0x3F,0x33,0x33,0x33,0x33,0x3F,0x66,0x60,0xC1},
{0x78,0x6C,0x60,0xFF,0x60,0x60,0x66,0x66,0x66,0x3C,0x3C,0x1B,0x3B,0x6F,0xC7,0x83},/*"成",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x00,0x00,0xFF,0x19,0x18,0x18,0x18,0x18,0x18,0x18,0x1F,0xF9,0x61,0x03,0x06},
{0x60,0x60,0x60,0x60,0xFE,0x66,0x66,0x66,0x66,0xC6,0xC6,0xC6,0x86,0x86,0x3C,0x18},/*"功",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};



static const uint8_t writeEncFailStr[][16]={
{0x18,0x1B,0x18,0x1B,0xFF,0x19,0x1F,0x1E,0x1C,0x3B,0xF9,0x19,0x18,0x18,0x79,0x37},
{0x1E,0xF0,0xC6,0x66,0xEC,0x98,0xFF,0x03,0x00,0xFC,0x8C,0x98,0xF0,0x60,0xF8,0x0F},/*"授",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x18,0x1B,0x19,0x19,0xFF,0x18,0x38,0x3C,0x7E,0x7E,0xD8,0x18,0x18,0x18,0x19,0x1F},
{0x00,0xFE,0x86,0x86,0x86,0xCC,0xCC,0xCC,0x78,0x78,0x30,0x30,0x78,0xCC,0x86,0x03},/*"权",1*/
/* (16 X 16 , 宋体, 加粗 )*/


{0x01,0x19,0x19,0x19,0x3F,0x31,0x61,0x01,0xFF,0x03,0x06,0x06,0x0C,0x18,0x30,0xE0},
{0x80,0x80,0x80,0x80,0xFC,0x80,0x80,0x80,0xFF,0xC0,0x60,0x60,0x30,0x18,0x0C,0x07},/*"失",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x7E,0x66,0x7E,0x7E,0x7F,0x7F,0x7E,0x7E,0x7E,0x7E,0x18,0x3C,0x36,0x67,0xC3},
{0x60,0x60,0x60,0xC0,0xFF,0x8C,0xCC,0xCC,0xCC,0x78,0x78,0x30,0x78,0xCC,0x86,0x03},/*"败",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};




static const uint8_t testStartStr[][16]={


{0x00,0x7F,0x0C,0x0C,0x0C,0x0C,0x0C,0xFF,0x0C,0x0C,0x0C,0x0C,0x18,0x18,0x30,0x60},
{0x00,0xFE,0x30,0x30,0x30,0x30,0x30,0xFF,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30},/*"开",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x18,0x18,0x18,0x18,0xFE,0x36,0x37,0x36,0x36,0x6C,0x3C,0x18,0x3C,0x66,0xC0,0x00},
{0x30,0x30,0x30,0x60,0x6C,0xC6,0xFF,0xC3,0x00,0xFE,0xC6,0xC6,0xC6,0xC6,0xFE,0xC6},/*"始",1*/
/* (16 X 16 , 宋体, 加粗 )*/



{0x00,0x37,0x1E,0x1E,0xC7,0x67,0x67,0x1F,0x1F,0x37,0xF7,0x31,0x33,0x33,0x36,0x0C},
{0x06,0xE6,0x66,0x7E,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0x86,0xC6,0x66,0x1E,0x0C},/*"测",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x30,0x18,0x18,0x07,0x00,0xF8,0x1F,0x19,0x19,0x19,0x1F,0x1D,0x1F,0x03,0x00},
{0x3C,0x36,0x36,0x30,0xFF,0x30,0x30,0xF0,0xB0,0x98,0x98,0x98,0xEF,0x8F,0x07,0x03},/*"试",1*/
/* (16 X 16 , 宋体, 加粗 )*/



};






static const uint8_t testOkStr[][16]={


{0x00,0x37,0x1E,0x1E,0xC7,0x67,0x67,0x1F,0x1F,0x37,0xF7,0x31,0x33,0x33,0x36,0x0C},
{0x06,0xE6,0x66,0x7E,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0x86,0xC6,0x66,0x1E,0x0C},/*"测",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x30,0x18,0x18,0x07,0x00,0xF8,0x1F,0x19,0x19,0x19,0x1F,0x1D,0x1F,0x03,0x00},
{0x3C,0x36,0x36,0x30,0xFF,0x30,0x30,0xF0,0xB0,0x98,0x98,0x98,0xEF,0x8F,0x07,0x03},/*"试",1*/
/* (16 X 16 , 宋体, 加粗 )*/


{0x00,0x00,0x00,0x3F,0x30,0x30,0x30,0x3F,0x33,0x33,0x33,0x33,0x3F,0x66,0x60,0xC1},
{0x78,0x6C,0x60,0xFF,0x60,0x60,0x66,0x66,0x66,0x3C,0x3C,0x1B,0x3B,0x6F,0xC7,0x83},/*"成",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x00,0x00,0xFF,0x19,0x18,0x18,0x18,0x18,0x18,0x18,0x1F,0xF9,0x61,0x03,0x06},
{0x60,0x60,0x60,0x60,0xFE,0x66,0x66,0x66,0x66,0xC6,0xC6,0xC6,0x86,0x86,0x3C,0x18},/*"功",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};



static const uint8_t testFailStr[][16]={


{0x00,0x37,0x1E,0x1E,0xC7,0x67,0x67,0x1F,0x1F,0x37,0xF7,0x31,0x33,0x33,0x36,0x0C},
{0x06,0xE6,0x66,0x7E,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0xFE,0x86,0xC6,0x66,0x1E,0x0C},/*"测",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x30,0x18,0x18,0x07,0x00,0xF8,0x1F,0x19,0x19,0x19,0x1F,0x1D,0x1F,0x03,0x00},
{0x3C,0x36,0x36,0x30,0xFF,0x30,0x30,0xF0,0xB0,0x98,0x98,0x98,0xEF,0x8F,0x07,0x03},/*"试",1*/
/* (16 X 16 , 宋体, 加粗 )*/




{0x01,0x19,0x19,0x19,0x3F,0x31,0x61,0x01,0xFF,0x03,0x06,0x06,0x0C,0x18,0x30,0xE0},
{0x80,0x80,0x80,0x80,0xFC,0x80,0x80,0x80,0xFF,0xC0,0x60,0x60,0x30,0x18,0x0C,0x07},/*"失",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x7E,0x66,0x7E,0x7E,0x7F,0x7F,0x7E,0x7E,0x7E,0x7E,0x18,0x3C,0x36,0x67,0xC3},
{0x60,0x60,0x60,0xC0,0xFF,0x8C,0xCC,0xCC,0xCC,0x78,0x78,0x30,0x78,0xCC,0x86,0x03},/*"败",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};



static const uint8_t snFailStr[][16]={

{0x00,0x7F,0x60,0xD8,0x18,0x1F,0x18,0x30,0x3F,0x00,0x00,0xFF,0x00,0x00,0x00,0x00},
{0x00,0xFF,0x03,0x06,0x00,0xFC,0x00,0x00,0xFC,0x0C,0x0C,0xEC,0x0C,0x0C,0x78,0x30},/*"写",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x00,0x00,0x3F,0x63,0x63,0x60,0x30,0x1C,0x06,0x03,0x63,0x63,0x7E,0x00,0x00},/*"S",1*/
/* (8 X 16 , 宋体, 加粗 )*/

{0x00,0x00,0x00,0xE7,0x73,0x73,0x7B,0x7B,0x6F,0x6F,0x6F,0x67,0x67,0xF3,0x00,0x00},/*"N",2*/
/* (8 X 16 , 宋体, 加粗 )*/

{0x01,0x19,0x19,0x19,0x3F,0x31,0x61,0x01,0xFF,0x03,0x06,0x06,0x0C,0x18,0x30,0xE0},
{0x80,0x80,0x80,0x80,0xFC,0x80,0x80,0x80,0xFF,0xC0,0x60,0x60,0x30,0x18,0x0C,0x07},/*"失",2*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x7E,0x66,0x7E,0x7E,0x7F,0x7F,0x7E,0x7E,0x7E,0x7E,0x18,0x3C,0x36,0x67,0xC3},
{0x60,0x60,0x60,0xC0,0xFF,0x8C,0xCC,0xCC,0xCC,0x78,0x78,0x30,0x78,0xCC,0x86,0x03},/*"败",3*/
/* (16 X 16 , 宋体, 加粗 )*/
};




static const uint8_t snCfgStr[][16]={


{0x30,0x3F,0x6C,0xC7,0x01,0x3F,0x01,0x01,0xFF,0x00,0x00,0x7F,0x0C,0x06,0x06,0x00},
{0x60,0xFF,0xD8,0x8C,0x80,0xFC,0x80,0x80,0xFF,0x00,0x30,0xFE,0x30,0x30,0xF0,0x60},/*"等",0*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x0C,0x0C,0x18,0x33,0x6C,0x0C,0x1F,0x38,0x78,0xDF,0x18,0x1B,0x19,0x19,0x18,0x18},
{0x60,0x60,0x60,0xFE,0x60,0x60,0xFF,0x18,0x18,0xFF,0x18,0x18,0x98,0x98,0x78,0x30},/*"待",1*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x00,0x00,0x00,0x3E,0x42,0x42,0x40,0x20,0x18,0x04,0x02,0x42,0x42,0x7C,0x00,0x00},/*"S",0*/
/* (8 X 16 , 宋体 )*/

{0x00,0x00,0x00,0xC7,0x62,0x62,0x52,0x52,0x4A,0x4A,0x4A,0x46,0x46,0xE2,0x00,0x00},/*"N",1*/
/* (8 X 16 , 宋体 )*/


{0x00,0xFF,0x3C,0x3C,0xFF,0xFF,0xFF,0xFF,0xFF,0xE3,0xC3,0xFF,0xC3,0xC3,0xFF,0xC3},
{0x00,0x00,0xFC,0x0C,0x0C,0x0C,0x0C,0xFC,0xCC,0xC0,0xC0,0xC0,0xC3,0xC3,0x7F,0x00},/*"配",4*/
/* (16 X 16 , 宋体, 加粗 )*/

{0x7F,0x66,0x7F,0x01,0x7F,0x01,0x1F,0x18,0x1F,0x18,0x1F,0x18,0x1F,0x18,0xFF,0x00},
{0xFE,0x66,0xFE,0x80,0xFE,0x80,0xF8,0x18,0xF8,0x18,0xF8,0x18,0xF8,0x18,0xFF,0x00},/*"置",5*/
/* (16 X 16 , 宋体, 加粗 )*/

};


static app_timer_id_t color_test_event_id=NULL;
/*
 * GLOBAL VARIABLE DEFINITIONS
 *****************************************************************************************
 */
extern calendar_handle_t g_calendar_handle;
extern gap_bdaddr_t          s_target_bdaddr;               /**< Target board address. */

uint16_t encOkCnt=0;
uint16_t encFailCnt=0;
uint16_t testOkCnt=0;
uint16_t testFailCnt=0;
/*
 * GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 */





/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_parameter_dispaly(void)//参数
{
    char logstr[36];
    uint8_t snbuff[17]={0};
    uint16_t snSize;
    calendar_time_t time;

    hal_calendar_get_time(&g_calendar_handle,&time);
    sprintf(logstr,"20%d-%d-%d",time.year,time.mon,time.date);  
    maxeye_put_str8_16(0,0,logstr);
    maxeye_read_device_sn(snbuff,&snSize);
    sprintf(logstr,"SN:%s",snbuff);
    maxeye_put_str8_16(0,16,logstr);
}



/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_gui_init(void)
{
    gui_init();
    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(~BLACK_COLOR,BACK_COLOR);
    // user_device_parameter_dispaly();
    // maxeye_put_gb2312_string(30,48,snCfgStr,5);
    gui_refresh();
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_sn_init(void)
{
    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(BLUE_COLOR,BACK_COLOR);
    user_device_parameter_dispaly();
    maxeye_put_gb2312_string(22,56,snCfgStr,5);
    gui_refresh();
}





/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_discover(void)
{
    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(BLUE_COLOR,BACK_COLOR);
    maxeye_put_gb2312_string(30,56,disCoverStr,4);
    gui_refresh();
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_wait_connect(void)
{
    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(~BLACK_COLOR,BACK_COLOR);
    maxeye_put_gb2312_string(30,56,waitStr,4);
    gui_refresh();
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_write_enc_ok(void)
{
    char logstr[36];
  

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(GREEN_COLOR,BACK_COLOR);

    user_device_parameter_dispaly();

    sprintf(logstr,"E-Ok  :%d",encOkCnt); 
    maxeye_put_gb2312_string(30,56,writeEncOkStr,4);
    encOkCnt++;
    sprintf(logstr,"E-Ok  :%d",encOkCnt); 
    maxeye_put_str8_16(0,80,logstr);
    sprintf(logstr,"E-Fail:%d",encFailCnt); 
    maxeye_put_str8_16(0,96,logstr);
    sprintf(logstr,"MAC:%02X %02X %02X %02X %02X %02X",
                    s_target_bdaddr.gap_addr.addr[5],
                    s_target_bdaddr.gap_addr.addr[4],
                    s_target_bdaddr.gap_addr.addr[3],
                    s_target_bdaddr.gap_addr.addr[2],
                    s_target_bdaddr.gap_addr.addr[1],
                    s_target_bdaddr.gap_addr.addr[0]); 
    gui_put_string5_7(0,112,logstr);
    gui_refresh();
}




/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_enc_ok(void)
{
    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(GREEN_COLOR,BACK_COLOR);
    maxeye_put_gb2312_string(38,56,encOkStr,3);
    sprintf(logstr,"E-Ok  :%d",encOkCnt); 
    maxeye_put_str8_16(0,96,logstr);
    sprintf(logstr,"E-Fail:%d",encFailCnt); 
    maxeye_put_str8_16(0,112,logstr);
    gui_refresh();
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_write_enc_fail(void)
{
    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(RED_COLOR,BACK_COLOR);
    maxeye_put_gb2312_string(30,56,writeEncFailStr,4);
    encFailCnt++;
    sprintf(logstr,"E-Ok  :%d",encOkCnt); 
    maxeye_put_str8_16(0,96,logstr);
    sprintf(logstr,"E-Fail:%d",encFailCnt); 
    maxeye_put_str8_16(0,112,logstr);
    gui_refresh();
}




/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_test_start(void)
{
//    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(BLUE_COLOR,BACK_COLOR);

    user_device_parameter_dispaly();
    maxeye_put_gb2312_string(30,56,testStartStr,4);
    gui_refresh();
}



/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_test_ok(void)
{
    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(GREEN_COLOR,BACK_COLOR);

    user_device_parameter_dispaly();

    maxeye_put_gb2312_string(30,56,testOkStr,4);
    testOkCnt++;
    sprintf(logstr,"T-Ok  :%d",testOkCnt); 
    maxeye_put_str8_16(0,96,logstr);
    sprintf(logstr,"T-Fail:%d",testFailCnt); 
    maxeye_put_str8_16(0,112,logstr);
    gui_refresh();
}






/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_test_fail(uint8_t *errcode)
{
    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(RED_COLOR,BACK_COLOR);

    maxeye_put_gb2312_string(30,56,testFailStr,4);
    testFailCnt++;
    sprintf(logstr,"T-Ok  :%d",testOkCnt); 
    maxeye_put_str8_16(0,80,logstr);
    sprintf(logstr,"T-Fail:%d",testFailCnt); 
    maxeye_put_str8_16(0,96,logstr);
    sprintf(logstr,"Code:%c%c%c%c",errcode[0],errcode[1],errcode[2],errcode[3]); 
    maxeye_put_str8_16(0,112,logstr);
    gui_refresh();
}




/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_device_write_sn_fail(void)
{
    // char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(RED_COLOR,BACK_COLOR);

    maxeye_put_gb2312_string(30,56,snFailStr,4);
    gui_refresh();
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void user_color_test(uint16_t wData)
{
    char logstr[36];

    gui_set_refresh_mem(true);
    gui_fill_mem(BACK_COLOR);
    gui_set_color(wData,BACK_COLOR);
    encFailCnt++;
    sprintf(logstr,"Ok  :%d",encOkCnt); 
    maxeye_put_str8_16(30,0,logstr);
    sprintf(logstr,"Fail:%d",encFailCnt); 
    maxeye_put_str8_16(30,20,logstr);
    maxeye_put_gb2312_string(30,56,writeEncFailStr,4);
    // maxeye_put_str8_16(48,88,"!!!!");
    gui_refresh();
}

/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
sdk_err_t color_test_event_start(uint16_t wDelaymS)
{
    sdk_err_t ret;

    ret=app_timer_start(color_test_event_id, wDelaymS, NULL);
    if(ret!=0)
    {
        printf("color test event start failed\r\n");
    }
    return ret;
}


/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
static void color_test_event_handler(void* p_ctx)
{
    user_color_test(encFailCnt);
    color_test_event_start(1000);   
}




/**
 *****************************************************************************************
 * @brief 
 *
 * @param[in]
 *
 * @return 
 *****************************************************************************************
 */
void color_test_event_register(void)
{
    sdk_err_t     error_code;

    error_code = app_timer_create(&color_test_event_id, ATIMER_ONE_SHOT, color_test_event_handler);
    APP_ERROR_CHECK(error_code);
    color_test_event_start(10000);
}
